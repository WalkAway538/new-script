local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local running = false
local TotalMoney = 0

-- UI Setup
local ScreenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "AutoRobUI"

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 220, 0, 340)
Frame.Position = UDim2.new(0.05, 0, 0.1, 0)
Frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Frame.BorderSizePixel = 0
Frame.ClipsDescendants = true

local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 12)

local Shadow = Instance.new("ImageLabel", Frame)
Shadow.Image = "rbxassetid://1316045217"
Shadow.ImageColor3 = Color3.new(0, 0, 0)
Shadow.ImageTransparency = 0.6
Shadow.ScaleType = Enum.ScaleType.Slice
Shadow.SliceCenter = Rect.new(10, 10, 118, 118)
Shadow.Size = UDim2.new(1, 30, 1, 30)
Shadow.Position = UDim2.new(0, -15, 0, -15)
Shadow.BackgroundTransparency = 1
Shadow.ZIndex = -1

local Title = Instance.new("TextLabel", Frame)
Title.Text = "Auto Rob - Jailbreak"
Title.Size = UDim2.new(1, 0, 0, 30)
Title.TextColor3 = Color3.new(1, 1, 1)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.TextScaled = true

local ToggleButton = Instance.new("TextButton", Frame)
ToggleButton.Text = "Start Auto Rob"
ToggleButton.Size = UDim2.new(1, -20, 0, 30)
ToggleButton.Position = UDim2.new(0, 10, 0, 40)
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Font = Enum.Font.Gotham
ToggleButton.TextScaled = true

local DropDown = Instance.new("TextButton", Frame)
DropDown.Text = "Prioritas: Museum"
DropDown.Size = UDim2.new(1, -20, 0, 30)
DropDown.Position = UDim2.new(0, 10, 0, 80)
DropDown.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
DropDown.TextColor3 = Color3.new(1, 1, 1)
DropDown.Font = Enum.Font.Gotham
DropDown.TextScaled = true

local function styleButton(btn)
	local corner = Instance.new("UICorner", btn)
	corner.CornerRadius = UDim.new(0, 8)
end
styleButton(ToggleButton)
styleButton(DropDown)

-- Prioritas & Checklist
local priorities = {"Museum", "Jewelry", "Bank", "CargoTrain"}
local currentPriority = 1

DropDown.MouseButton1Click:Connect(function()
	currentPriority = currentPriority + 1
	if currentPriority > #priorities then currentPriority = 1 end
	DropDown.Text = "Prioritas: " .. priorities[currentPriority]
end)

local locationToggles = {
	Museum = true,
	Jewelry = true,
	Bank = true,
	CargoTrain = true
}

local yOffset = 120
for _, name in ipairs(priorities) do
	local btn = Instance.new("TextButton", Frame)
	btn.Size = UDim2.new(1, -20, 0, 25)
	btn.Position = UDim2.new(0, 10, 0, yOffset)
	yOffset += 30
	btn.Text = "✔️ " .. name
	btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Font = Enum.Font.Gotham
	btn.TextScaled = true
	styleButton(btn)

	btn.MouseButton1Click:Connect(function()
		locationToggles[name] = not locationToggles[name]
		btn.Text = (locationToggles[name] and "✔️ " or "❌ ") .. name
	end)
end

-- Log status
local StatusLog = Instance.new("TextLabel", Frame)
StatusLog.Size = UDim2.new(1, -20, 0, 25)
StatusLog.Position = UDim2.new(0, 10, 1, -30)
StatusLog.BackgroundTransparency = 1
StatusLog.TextColor3 = Color3.new(1, 1, 1)
StatusLog.Font = Enum.Font.Gotham
StatusLog.TextScaled = true
StatusLog.Text = "Status: Menunggu..."

function updateStatus(msg)
	StatusLog.Text = "Status: " .. msg
end

-- Notifikasi
function showNotification(text)
	local notif = Instance.new("TextLabel", ScreenGui)
	notif.Size = UDim2.new(0, 250, 0, 40)
	notif.Position = UDim2.new(1, -270, 1, -60)
	notif.BackgroundColor3 = Color3.fromRGB(40, 180, 80)
	notif.Text = text
	notif.TextColor3 = Color3.new(1, 1, 1)
	notif.Font = Enum.Font.GothamBold
	notif.TextScaled = true
	notif.ZIndex = 999
	notif.AnchorPoint = Vector2.new(1,1)
	notif.ClipsDescendants = true

	TweenService:Create(notif, TweenInfo.new(0.4), {Position = UDim2.new(1, -270, 1, -100)}):Play()
	wait(2.5)
	TweenService:Create(notif, TweenInfo.new(0.3), {TextTransparency = 1, BackgroundTransparency = 1}):Play()
	wait(0.5)
	notif:Destroy()
end

-- Fungsi Robbery
function teleportTo(position)
	Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	if Character:FindFirstChild("HumanoidRootPart") then
		Character.HumanoidRootPart.CFrame = CFrame.new(position + Vector3.new(0, 5, 0))
	end
end

function isRobberyAvailable(name)
	if name == "Museum" then
		local doors = workspace:FindFirstChild("Museum") and workspace.Museum:FindFirstChild("Doors")
		return doors and doors:FindFirstChild("Door1") and doors.Door1.Transparency < 1
	elseif name == "Jewelry" then
		return workspace:FindFirstChild("JewelrysStore") and workspace.JewelrysStore:FindFirstChild("Glass")
	elseif name == "Bank" then
		return workspace:FindFirstChild("Bank") and workspace.Bank:FindFirstChild("Doors")
	elseif name == "CargoTrain" then
		return workspace:FindFirstChild("Train") ~= nil
	end
end

function isPoliceNearby(range)
	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Team.Name == "Police" then
			local char = player.Character
			if char and char:FindFirstChild("HumanoidRootPart") then
				local dist = (char.HumanoidRootPart.Position - Character.HumanoidRootPart.Position).Magnitude
				if dist <= range then return true end
			end
		end
	end
	return false
end

function autoEscape()
	local safePos = Vector3.new(1684, 50, -1763)
	teleportTo(safePos)
end

function autoBreakJewelryGlass()
	local glassParts = workspace.JewelrysStore and workspace.JewelrysStore:FindFirstChild("Glass")
	if glassParts then
		for _, glass in ipairs(glassParts:GetChildren()) do
			if glass:IsA("BasePart") and (glass.Position - Character.HumanoidRootPart.Position).Magnitude < 20 then
				firetouchinterest(Character.HumanoidRootPart, glass, 0)
				task.wait(0.1)
				firetouchinterest(Character.HumanoidRootPart, glass, 1)
			end
		end
	end
end

function autoLootMuseum()
	local museum = workspace:FindFirstChild("Museum")
	if museum then
		for _, item in ipairs(museum:GetDescendants()) do
			if item:IsA("BasePart") and item.Name == "Grab" then
				firetouchinterest(Character.HumanoidRootPart, item, 0)
				task.wait(0.1)
				firetouchinterest(Character.HumanoidRootPart, item, 1)
			end
		end
	end
end

function rob(target)
	if not locationToggles[target] then return end
	updateStatus("Merampok " .. target)

	if target == "Museum" then
		teleportTo(Vector3.new(1086, 117, 1246)); wait(1)
		autoLootMuseum()
	elseif target == "Jewelry" then
		teleportTo(Vector3.new(135, 17, 1320)); wait(1)
		autoBreakJewelryGlass()
	elseif target == "Bank" then
		teleportTo(Vector3.new(29, 17, 875)); wait(2)
	elseif target == "CargoTrain" then
		local train = workspace:FindFirstChild("Train")
		if train then
			for _, v in ipairs(train:GetDescendants()) do
				if v:IsA("BasePart") and v.Name == "Door" then
					teleportTo(v.Position)
					break
				end
			end
		end
	end

	wait(2)
	autoEscape()
	local gain = math.random(4500, 7500)
	TotalMoney += gain
	showNotification("Sukses merampok " .. target)
	updateStatus("Berhasil: " .. target .. " | +" .. gain .. "$ | Total: " .. TotalMoney .. "$")
end

function startAutoRob()
	task.spawn(function()
		while running do
			local target = priorities[currentPriority]
			if isRobberyAvailable(target) and not isPoliceNearby(100) and locationToggles[target] then
				rob(target)
			end
			wait(5)
		end
	end)
end

ToggleButton.MouseButton1Click:Connect(function()
	running = not running
	ToggleButton.Text = running and "Stop Auto Rob" or "Start Auto Rob"
	if running then
		startAutoRob()
	end
end)
